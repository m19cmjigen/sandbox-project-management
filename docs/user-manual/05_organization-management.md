# 組織管理

組織管理ページでは、組織の追加・編集・削除を行えます。また、組織に紐付けられていないプロジェクトの確認と組織への割り当ても可能です。

## 画面へのアクセス

ナビゲーションバーの **「管理」** → **「組織管理」** をクリックします。

または直接 `/organizations/manage` にアクセスします。

## 画面構成

```
┌─────────────────────────────────────────────────────────────────┐
│ 組織管理                                                        │
│                                                                 │
│  ┌─────────────────────────┐  ┌──────────────────────────────┐ │
│  │ 組織ツリー    [本部を追加] │  │ 未分類プロジェクト  [3]       │ │
│  │─────────────────────────│  │──────────────────────────────│ │
│  │ 開発本部       [Lv.0][3件]│  │ PROJ-X プロジェクトX   [割当] │ │
│  │   ┣ 開発部     [Lv.1][2件]│  │ PROJ-Y プロジェクトY   [割当] │ │
│  │   ┗ インフラ部 [Lv.1][1件]│  │ PROJ-Z プロジェクトZ   [割当] │ │
│  │ 営業本部       [Lv.0][1件]│  │                              │ │
│  └─────────────────────────┘  └──────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

## 組織の追加

### 本部（最上位組織）を追加する

1. **「本部を追加」** ボタンをクリックする
2. ダイアログが開いたら **「組織名」** を入力する
3. **「親組織（省略可）」** は「なし（本部として追加）」のままにする
4. **「保存」** ボタンをクリックする

### 部・課（子組織）を追加する

**方法1: ツリーから追加**

1. 親にしたい組織の行にある **「+」アイコン** をクリックする
2. ダイアログが開き、親組織が自動的に選択されている
3. **「組織名」** を入力して **「保存」** をクリックする

**方法2: ダイアログで親を選択**

1. **「本部を追加」** ボタンをクリックする
2. **「親組織（省略可）」** ドロップダウンから親組織を選択する
3. **「組織名」** を入力して **「保存」** をクリックする

### 注意事項

- 組織の階層は最大3レベル（本部→部→課）です
- 既に部が存在する組織（レベル0）にのみ、さらに子組織（部、レベル1）を追加できます
- レベル1の組織（部）には子組織を追加できません

## 組織の編集

1. 編集したい組織の行にある **「編集（鉛筆）アイコン」** をクリックする
2. ダイアログが開いたら **「組織名」** を変更する
3. **「保存」** ボタンをクリックする

編集できるのは **組織名のみ** です。親組織の変更はできません。

## 組織の削除

1. 削除したい組織の行にある **「削除（ゴミ箱）アイコン」** をクリックする
2. 確認ダイアログが表示される
3. **「削除」** ボタンをクリックする

### 削除できない場合

以下の条件を満たす組織は削除できません:

| 条件 | エラーメッセージ |
|---|---|
| 子組織が存在する | cannot delete organization with child organizations |
| プロジェクトが割り当てられている | cannot delete organization with N assigned project(s) |

削除したい場合は先に子組織を削除するか、プロジェクトの割り当てを解除してください。

## 操作後のフィードバック

操作が成功すると、画面上部に緑色の成功メッセージが3秒間表示されます。

```
例:「開発部」を作成しました
    「開発部」を更新しました
    「開発部」を削除しました
```

エラーが発生した場合は赤色のエラーメッセージが表示されます。「×」ボタンで閉じることができます。
